import{S as t,i as e,s,e as a,t as r,k as n,c as l,a as o,g as i,n as c,d as f,b as $,Y as p,f as m,F as u,h as d,j as g,m as h,E as v,o as k,v as w,r as x,w as j,Q as b,T as y}from"../../chunks/vendor-e2340380.js";import{p as E}from"../../chunks/stores-f5e22436.js";import{T as D}from"../../chunks/Title-cfc72760.js";import{E as O}from"../../chunks/Events-0433dd7a.js";import{H as Y}from"../../chunks/Head-5eb7aaf5.js";import{u as q}from"../../chunks/utils-bd9c12ba.js";import"../../chunks/Timestamp-3eaaac1e.js";import"../../chunks/Tag-e585ff94.js";import"../../chunks/EzeMedia-16fb6722.js";import"../../chunks/_stores-6417d3b8.js";import"../../chunks/MapLink-97a0a13c.js";function I(t,e,s){const a=t.slice();return a[5]=e[s],a[7]=s,a}function T(t){let e;return{c(){e=r(t[0])},l(s){e=i(s,t[0])},m(t,s){m(t,e,s)},p(t,s){1&s&&d(e,t[0])},d(t){t&&f(e)}}}function M(t){let e,s,g,h,v=t[5]+"";return{c(){e=a("a"),s=r(v),g=n(),this.h()},l(t){e=l(t,"A",{class:!0,href:!0});var a=o(e);s=i(a,v),g=c(a),a.forEach(f),this.h()},h(){$(e,"class","br bb plr1 ptb0-5 block text-center"),$(e,"href",h=`?q=${t[5]}`),p(e,"filled",t[2]==t[5]||"all"==t[5]&&-1==t[1].indexOf(t[2]))},m(t,a){m(t,e,a),u(e,s),u(e,g)},p(t,a){8&a&&v!==(v=t[5]+"")&&d(s,v),8&a&&h!==(h=`?q=${t[5]}`)&&$(e,"href",h),14&a&&p(e,"filled",t[2]==t[5]||"all"==t[5]&&-1==t[1].indexOf(t[2]))},d(t){t&&f(e)}}}function F(t){let e,s,r,i,p,d;r=new D({props:{$$slots:{default:[T]},$$scope:{ctx:t}}});let y=t[3],E=[];for(let a=0;a<y.length;a+=1)E[a]=M(I(t,y,a));return{c(){e=a("div"),s=a("div"),g(r.$$.fragment),i=n(),p=a("div");for(let t=0;t<E.length;t+=1)E[t].c();this.h()},l(t){e=l(t,"DIV",{class:!0});var a=o(e);s=l(a,"DIV",{class:!0});var n=o(s);h(r.$$.fragment,n),n.forEach(f),i=c(a),p=l(a,"DIV",{class:!0,style:!0});var $=o(p);for(let e=0;e<E.length;e+=1)E[e].l($);$.forEach(f),a.forEach(f),this.h()},h(){$(s,"class","minw12em"),$(p,"class","row flex wrap bl mb1 bt"),v(p,"margin-top","calc(var(--stroke-width)*-1)"),$(e,"class","flex row-space-between-flex-start wrap")},m(t,a){m(t,e,a),u(e,s),k(r,s,null),u(e,i),u(e,p);for(let e=0;e<E.length;e+=1)E[e].m(p,null);d=!0},p(t,[e]){const s={};if(257&e&&(s.$$scope={dirty:e,ctx:t}),r.$set(s),14&e){let s;for(y=t[3],s=0;s<y.length;s+=1){const a=I(t,y,s);E[s]?E[s].p(a,e):(E[s]=M(a),E[s].c(),E[s].m(p,null))}for(;s<E.length;s+=1)E[s].d(1);E.length=y.length}},i(t){d||(w(r.$$.fragment,t),d=!0)},o(t){x(r.$$.fragment,t),d=!1},d(t){t&&f(e),j(r),b(E,t)}}}function V(t,e,s){let a,r,n;y(t,E,(t=>s(4,n=t)));let{title:l=""}=e,{tags:o=[]}=e;return t.$$set=t=>{"title"in t&&s(0,l=t.title),"tags"in t&&s(1,o=t.tags)},t.$$.update=()=>{16&t.$$.dirty&&s(2,a=n.query.get("q")),2&t.$$.dirty&&s(3,r=["all",...o])},[l,o,a,r,n]}class H extends t{constructor(t){super(),e(this,t,V,F,s,{title:0,tags:1})}}function z(t){var e,s,a;let r,l,o,i,$,p;return r=new Y({props:{title:"Events, workshops, talks + performances",description:t[0].map(t[6]).join(", "),image:null==(a=null==(s=null==(e=t[0])?void 0:e[0])?void 0:s.cover)?void 0:a[0]}}),o=new H({props:{title:"Events",tags:t[1].concat(t[2])}}),$=new O({props:{events:t[3],alternate:!1}}),{c(){g(r.$$.fragment),l=n(),g(o.$$.fragment),i=n(),g($.$$.fragment)},l(t){h(r.$$.fragment,t),l=c(t),h(o.$$.fragment,t),i=c(t),h($.$$.fragment,t)},m(t,e){k(r,t,e),m(t,l,e),k(o,t,e),m(t,i,e),k($,t,e),p=!0},p(t,[e]){var s,a,n;const l={};1&e&&(l.description=t[0].map(t[6]).join(", ")),1&e&&(l.image=null==(n=null==(a=null==(s=t[0])?void 0:s[0])?void 0:a.cover)?void 0:n[0]),r.$set(l);const i={};6&e&&(i.tags=t[1].concat(t[2])),o.$set(i);const c={};8&e&&(c.events=t[3]),$.$set(c)},i(t){p||(w(r.$$.fragment,t),w(o.$$.fragment,t),w($.$$.fragment,t),p=!0)},o(t){x(r.$$.fragment,t),x(o.$$.fragment,t),x($.$$.fragment,t),p=!1},d(t){j(r,t),t&&f(l),j(o,t),t&&f(i),j($,t)}}}const A=async({fetch:t,page:e})=>{console.log(e);let s=[],a=[];return{props:{events:(await(await t("/events.json")).json()).sort(((t,e)=>e.start-t.start)).map((t=>{let e=new Date(1e3*t.start).getFullYear();return-1==a.indexOf(e)&&a.push(e),(t.tags||[]).forEach((t=>{-1==s.indexOf(t.id)&&s.push(t.id)})),t})),tags:s,years:a}}};function L(t,e,s){let a,r,n;y(t,E,(t=>s(5,n=t)));let{events:l}=e,{tags:o}=e,{years:i}=e;return t.$$set=t=>{"events"in t&&s(0,l=t.events),"tags"in t&&s(1,o=t.tags),"years"in t&&s(2,i=t.years)},t.$$.update=()=>{32&t.$$.dirty&&s(4,a=n.query.get("q")),23&t.$$.dirty&&s(3,r=l.filter((t=>-1!=o.indexOf(a)?-1!=((null==t?void 0:t.tags)||[]).map((t=>t.id)).indexOf(a):-1==i.indexOf(parseInt(a))||new Date(1e3*t.start).getFullYear()==parseInt(a))))},[l,o,i,r,a,n,t=>`${t.title} (${q.timestamp(t.start,"DD-MM-YYYY")})`]}export default class extends t{constructor(t){super(),e(this,t,L,z,s,{events:0,tags:1,years:2})}}export{A as load};
