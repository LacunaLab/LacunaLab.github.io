import{S as t,i as s,s as e,j as a,k as n,m as r,n as o,o as i,f as m,v as c,r as p,w as l,d as $,T as f}from"../../chunks/vendor-60623916.js";import{p as u}from"../../chunks/stores-6f3ba01c.js";import{F as d}from"../../chunks/Filters-54fc7943.js";import{E as g}from"../../chunks/Events-4ba39676.js";import{H as v}from"../../chunks/Head-f78c8e4f.js";import{u as h}from"../../chunks/utils-b0a22032.js";import"../../chunks/Title-989d96c5.js";import"../../chunks/Timestamp-985d8836.js";import"../../chunks/Tag-87237adc.js";import"../../chunks/EzeMedia-249266b8.js";import"../../chunks/_stores-88dd5ace.js";function j(t){var s,e,f;let u,h,j,k,w,y;return u=new v({props:{title:"Events, workshops, talks + performances",description:t[0].map(t[6]).join(", "),image:null==(f=null==(e=null==(s=t[0])?void 0:s[0])?void 0:e.cover)?void 0:f[0]}}),j=new d({props:{title:"Events",tags:t[1].concat(t[2])}}),w=new g({props:{events:t[3],alternate:!1}}),{c(){a(u.$$.fragment),h=n(),a(j.$$.fragment),k=n(),a(w.$$.fragment)},l(t){r(u.$$.fragment,t),h=o(t),r(j.$$.fragment,t),k=o(t),r(w.$$.fragment,t)},m(t,s){i(u,t,s),m(t,h,s),i(j,t,s),m(t,k,s),i(w,t,s),y=!0},p(t,[s]){var e,a,n;const r={};1&s&&(r.description=t[0].map(t[6]).join(", ")),1&s&&(r.image=null==(n=null==(a=null==(e=t[0])?void 0:e[0])?void 0:a.cover)?void 0:n[0]),u.$set(r);const o={};6&s&&(o.tags=t[1].concat(t[2])),j.$set(o);const i={};8&s&&(i.events=t[3]),w.$set(i)},i(t){y||(c(u.$$.fragment,t),c(j.$$.fragment,t),c(w.$$.fragment,t),y=!0)},o(t){p(u.$$.fragment,t),p(j.$$.fragment,t),p(w.$$.fragment,t),y=!1},d(t){l(u,t),t&&$(h),l(j,t),t&&$(k),l(w,t)}}}const k=async({fetch:t,page:s})=>{console.log(s);let e=[],a=[];return{props:{events:(await(await t("/events.json")).json()).sort(((t,s)=>s.start-t.start)).map((t=>{let s=new Date(1e3*t.start).getFullYear();return-1==a.indexOf(s)&&a.push(s),(t.tags||[]).forEach((t=>{-1==e.indexOf(t.id)&&e.push(t.id)})),t})),tags:e,years:a}}};function w(t,s,e){let a,n,r;f(t,u,(t=>e(5,r=t)));let{events:o}=s,{tags:i}=s,{years:m}=s;return t.$$set=t=>{"events"in t&&e(0,o=t.events),"tags"in t&&e(1,i=t.tags),"years"in t&&e(2,m=t.years)},t.$$.update=()=>{32&t.$$.dirty&&e(4,a=r.query.get("q")),23&t.$$.dirty&&e(3,n=o.filter((t=>-1!=i.indexOf(a)?-1!=((null==t?void 0:t.tags)||[]).map((t=>t.id)).indexOf(a):-1==m.indexOf(parseInt(a))||new Date(1e3*t.start).getFullYear()==parseInt(a))))},[o,i,m,n,a,r,t=>`${t.title} (${h.timestamp(t.start,"DD-MM-YYYY")})`]}export default class extends t{constructor(t){super(),s(this,t,w,j,e,{events:0,tags:1,years:2})}}export{k as load};
