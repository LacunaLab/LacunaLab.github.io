import{S as t,i as e,s,e as a,t as r,k as n,c as l,a as i,g as o,n as c,d as f,b as $,Y as m,f as p,F as h,h as u,j as g,m as d,E as v,o as x,v as w,r as b,w as j,Q as k,T as y}from"../../chunks/vendor-d8848aa7.js";import{p as E}from"../../chunks/stores-fd2cc8b4.js";import{T as D}from"../../chunks/Title-56b8e34e.js";import{E as O}from"../../chunks/Events-eacf01a0.js";import{H as Y}from"../../chunks/Head-3a8bf723.js";import{u as q}from"../../chunks/utils-7b57918c.js";import"../../chunks/Timestamp-94a97e80.js";import"../../chunks/EzeMedia-f0572190.js";import"../../chunks/_stores-05686e17.js";function I(t,e,s){const a=t.slice();return a[5]=e[s],a[7]=s,a}function T(t){let e;return{c(){e=r(t[0])},l(s){e=o(s,t[0])},m(t,s){p(t,e,s)},p(t,s){1&s&&u(e,t[0])},d(t){t&&f(e)}}}function A(t){let e,s,g,d,v=t[5]+"";return{c(){e=a("a"),s=r(v),g=n(),this.h()},l(t){e=l(t,"A",{class:!0,href:!0});var a=i(e);s=o(a,v),g=c(a),a.forEach(f),this.h()},h(){$(e,"class","br bb plr1 ptb0-5 block text-center grow"),$(e,"href",d=`?q=${t[5]}`),m(e,"filled",t[2]==t[5]||"all"==t[5]&&-1==t[1].indexOf(t[2]))},m(t,a){p(t,e,a),h(e,s),h(e,g)},p(t,a){8&a&&v!==(v=t[5]+"")&&u(s,v),8&a&&d!==(d=`?q=${t[5]}`)&&$(e,"href",d),14&a&&m(e,"filled",t[2]==t[5]||"all"==t[5]&&-1==t[1].indexOf(t[2]))},d(t){t&&f(e)}}}function F(t){let e,s,r,o,m,u;r=new D({props:{$$slots:{default:[T]},$$scope:{ctx:t}}});let y=t[3],E=[];for(let a=0;a<y.length;a+=1)E[a]=A(I(t,y,a));return{c(){e=a("div"),s=a("div"),g(r.$$.fragment),o=n(),m=a("div");for(let t=0;t<E.length;t+=1)E[t].c();this.h()},l(t){e=l(t,"DIV",{class:!0});var a=i(e);s=l(a,"DIV",{class:!0});var n=i(s);d(r.$$.fragment,n),n.forEach(f),o=c(a),m=l(a,"DIV",{class:!0,style:!0});var $=i(m);for(let e=0;e<E.length;e+=1)E[e].l($);$.forEach(f),a.forEach(f),this.h()},h(){$(s,"class","minw12em"),$(m,"class","row flex wrap bl mb1 bt"),v(m,"margin-top","calc(var(--stroke-width)*-1)"),$(e,"class","flex row-space-between-flex-start wrap")},m(t,a){p(t,e,a),h(e,s),x(r,s,null),h(e,o),h(e,m);for(let e=0;e<E.length;e+=1)E[e].m(m,null);u=!0},p(t,[e]){const s={};if(257&e&&(s.$$scope={dirty:e,ctx:t}),r.$set(s),14&e){let s;for(y=t[3],s=0;s<y.length;s+=1){const a=I(t,y,s);E[s]?E[s].p(a,e):(E[s]=A(a),E[s].c(),E[s].m(m,null))}for(;s<E.length;s+=1)E[s].d(1);E.length=y.length}},i(t){u||(w(r.$$.fragment,t),u=!0)},o(t){b(r.$$.fragment,t),u=!1},d(t){t&&f(e),j(r),k(E,t)}}}function M(t,e,s){let a,r,n;y(t,E,(t=>s(4,n=t)));let{title:l=""}=e,{tags:i=[]}=e;return t.$$set=t=>{"title"in t&&s(0,l=t.title),"tags"in t&&s(1,i=t.tags)},t.$$.update=()=>{16&t.$$.dirty&&s(2,a=n.query.get("q")),2&t.$$.dirty&&s(3,r=["all",...i])},[l,i,a,r,n]}class V extends t{constructor(t){super(),e(this,t,M,F,s,{title:0,tags:1})}}function H(t){var e,s,r;let o,m,h,u,v,k,y,E;return o=new Y({props:{title:"Exhibitions, workshops, meetups, talks, performances",description:t[0].map(t[6]).join(", "),image:null==(r=null==(s=null==(e=t[0])?void 0:e[0])?void 0:s.cover)?void 0:r[0]}}),h=new V({props:{title:"Activities",tags:t[1].concat(t[2])}}),v=new O({props:{events:t[3],alternate:!1,stretch:"height",format:"500x0x90"}}),{c(){g(o.$$.fragment),m=n(),g(h.$$.fragment),u=n(),g(v.$$.fragment),k=n(),y=a("span"),this.h()},l(t){d(o.$$.fragment,t),m=c(t),d(h.$$.fragment,t),u=c(t),d(v.$$.fragment,t),k=c(t),y=l(t,"SPAN",{class:!0}),i(y).forEach(f),this.h()},h(){$(y,"class","h2em")},m(t,e){x(o,t,e),p(t,m,e),x(h,t,e),p(t,u,e),x(v,t,e),p(t,k,e),p(t,y,e),E=!0},p(t,[e]){var s,a,r;const n={};1&e&&(n.description=t[0].map(t[6]).join(", ")),1&e&&(n.image=null==(r=null==(a=null==(s=t[0])?void 0:s[0])?void 0:a.cover)?void 0:r[0]),o.$set(n);const l={};6&e&&(l.tags=t[1].concat(t[2])),h.$set(l);const i={};8&e&&(i.events=t[3]),v.$set(i)},i(t){E||(w(o.$$.fragment,t),w(h.$$.fragment,t),w(v.$$.fragment,t),E=!0)},o(t){b(o.$$.fragment,t),b(h.$$.fragment,t),b(v.$$.fragment,t),E=!1},d(t){j(o,t),t&&f(m),j(h,t),t&&f(u),j(v,t),t&&f(k),t&&f(y)}}}const S=async({fetch:t,page:e})=>{console.log(e);let s=[],a=[];return{props:{events:(await(await t("/events.json")).json()).sort(((t,e)=>e.start-t.start)).map((t=>{let e=new Date(1e3*t.start).getFullYear();return-1==a.indexOf(e)&&a.push(e),(t.tags||[]).forEach((t=>{-1==s.indexOf(t.id)&&s.push(t.id)})),t})),tags:s,years:a}}};function z(t,e,s){let a,r,n;y(t,E,(t=>s(5,n=t)));let{events:l}=e,{tags:i}=e,{years:o}=e;return t.$$set=t=>{"events"in t&&s(0,l=t.events),"tags"in t&&s(1,i=t.tags),"years"in t&&s(2,o=t.years)},t.$$.update=()=>{32&t.$$.dirty&&s(4,a=n.query.get("q")),23&t.$$.dirty&&s(3,r=l.filter((t=>-1!=i.indexOf(a)?-1!=((null==t?void 0:t.tags)||[]).map((t=>t.id)).indexOf(a):-1==o.indexOf(parseInt(a))||new Date(1e3*t.start).getFullYear()==parseInt(a))))},[l,i,o,r,a,n,t=>`${t.title} (${q.timestamp(t.start,"DD-MM-YYYY")})`]}export default class extends t{constructor(t){super(),e(this,t,z,H,s,{events:0,tags:1,years:2})}}export{S as load};
