import{S as t,i as e,s,e as a,t as r,k as n,c as i,a as l,g as c,n as o,d as f,b as $,Y as p,f as h,F as m,h as g,j as d,m as u,E as v,o as x,v as w,r as j,w as y,Q as b,T as k}from"../../chunks/vendor-1c7a3457.js";import{p as E}from"../../chunks/stores-5863d674.js";import{T as D}from"../../chunks/Title-1deb1cc6.js";import{E as O}from"../../chunks/Events-f6cfaebe.js";import{H as Y}from"../../chunks/Head-3160acd1.js";import{u as q}from"../../chunks/utils-0aafa1d0.js";import"../../chunks/Timestamp-62a4dd23.js";import"../../chunks/EzeMedia-2f946399.js";import"../../chunks/_stores-679a7eb8.js";function I(t,e,s){const a=t.slice();return a[5]=e[s],a[7]=s,a}function A(t){let e;return{c(){e=r(t[0])},l(s){e=c(s,t[0])},m(t,s){h(t,e,s)},p(t,s){1&s&&g(e,t[0])},d(t){t&&f(e)}}}function T(t){let e,s,d,u,v=t[5]+"";return{c(){e=a("a"),s=r(v),d=n(),this.h()},l(t){e=i(t,"A",{class:!0,href:!0});var a=l(e);s=c(a,v),d=o(a),a.forEach(f),this.h()},h(){$(e,"class","br bb plr1 ptb0-5 block text-center grow"),$(e,"href",u=`?q=${t[5]}`),p(e,"filled",t[2]==t[5]||"all"==t[5]&&-1==t[1].indexOf(t[2]))},m(t,a){h(t,e,a),m(e,s),m(e,d)},p(t,a){8&a&&v!==(v=t[5]+"")&&g(s,v),8&a&&u!==(u=`?q=${t[5]}`)&&$(e,"href",u),14&a&&p(e,"filled",t[2]==t[5]||"all"==t[5]&&-1==t[1].indexOf(t[2]))},d(t){t&&f(e)}}}function F(t){let e,s,r,c,p,g;r=new D({props:{$$slots:{default:[A]},$$scope:{ctx:t}}});let k=t[3],E=[];for(let a=0;a<k.length;a+=1)E[a]=T(I(t,k,a));return{c(){e=a("div"),s=a("div"),d(r.$$.fragment),c=n(),p=a("div");for(let t=0;t<E.length;t+=1)E[t].c();this.h()},l(t){e=i(t,"DIV",{class:!0});var a=l(e);s=i(a,"DIV",{class:!0});var n=l(s);u(r.$$.fragment,n),n.forEach(f),c=o(a),p=i(a,"DIV",{class:!0,style:!0});var $=l(p);for(let e=0;e<E.length;e+=1)E[e].l($);$.forEach(f),a.forEach(f),this.h()},h(){$(s,"class","minw12em"),$(p,"class","row flex wrap bl mb1 bt"),v(p,"margin-top","calc(var(--stroke-width)*-1)"),$(e,"class","flex row-space-between-flex-start wrap")},m(t,a){h(t,e,a),m(e,s),x(r,s,null),m(e,c),m(e,p);for(let e=0;e<E.length;e+=1)E[e].m(p,null);g=!0},p(t,[e]){const s={};if(257&e&&(s.$$scope={dirty:e,ctx:t}),r.$set(s),14&e){let s;for(k=t[3],s=0;s<k.length;s+=1){const a=I(t,k,s);E[s]?E[s].p(a,e):(E[s]=T(a),E[s].c(),E[s].m(p,null))}for(;s<E.length;s+=1)E[s].d(1);E.length=k.length}},i(t){g||(w(r.$$.fragment,t),g=!0)},o(t){j(r.$$.fragment,t),g=!1},d(t){t&&f(e),y(r),b(E,t)}}}function M(t,e,s){let a,r,n;k(t,E,(t=>s(4,n=t)));let{title:i=""}=e,{tags:l=[]}=e;return t.$$set=t=>{"title"in t&&s(0,i=t.title),"tags"in t&&s(1,l=t.tags)},t.$$.update=()=>{16&t.$$.dirty&&s(2,a=n.query.get("q")),2&t.$$.dirty&&s(3,r=["all",...l])},[i,l,a,r,n]}class V extends t{constructor(t){super(),e(this,t,M,F,s,{title:0,tags:1})}}function H(t){let e,s,r,c,p,m,g,v;return e=new Y({props:{title:"Activities & Events",description:t[0].map(t[6]).join(", ")}}),r=new V({props:{title:"Activities",tags:t[1].concat(t[2])}}),p=new O({props:{events:t[3],alternate:!1,stretch:"height",format:"500x0x90"}}),{c(){d(e.$$.fragment),s=n(),d(r.$$.fragment),c=n(),d(p.$$.fragment),m=n(),g=a("span"),this.h()},l(t){u(e.$$.fragment,t),s=o(t),u(r.$$.fragment,t),c=o(t),u(p.$$.fragment,t),m=o(t),g=i(t,"SPAN",{class:!0}),l(g).forEach(f),this.h()},h(){$(g,"class","h2em")},m(t,a){x(e,t,a),h(t,s,a),x(r,t,a),h(t,c,a),x(p,t,a),h(t,m,a),h(t,g,a),v=!0},p(t,[s]){const a={};1&s&&(a.description=t[0].map(t[6]).join(", ")),e.$set(a);const n={};6&s&&(n.tags=t[1].concat(t[2])),r.$set(n);const i={};8&s&&(i.events=t[3]),p.$set(i)},i(t){v||(w(e.$$.fragment,t),w(r.$$.fragment,t),w(p.$$.fragment,t),v=!0)},o(t){j(e.$$.fragment,t),j(r.$$.fragment,t),j(p.$$.fragment,t),v=!1},d(t){y(e,t),t&&f(s),y(r,t),t&&f(c),y(p,t),t&&f(m),t&&f(g)}}}const S=async({fetch:t,page:e})=>{let s=[],a=[];return{props:{events:(await(await t("/events.json")).json()).sort(((t,e)=>e.start-t.start)).map((t=>{let e=new Date(1e3*t.start).getFullYear();return-1==a.indexOf(e)&&a.push(e),(t.tags||[]).forEach((t=>{-1==s.indexOf(t.id)&&s.push(t.id)})),t})),tags:s,years:a}}};function z(t,e,s){let a,r,n;k(t,E,(t=>s(5,n=t)));let{events:i}=e,{tags:l}=e,{years:c}=e;return t.$$set=t=>{"events"in t&&s(0,i=t.events),"tags"in t&&s(1,l=t.tags),"years"in t&&s(2,c=t.years)},t.$$.update=()=>{32&t.$$.dirty&&s(4,a=n.query.get("q")),23&t.$$.dirty&&s(3,r=i.filter((t=>-1!=l.indexOf(a)?-1!=((null==t?void 0:t.tags)||[]).map((t=>t.id)).indexOf(a):-1==c.indexOf(parseInt(a))||new Date(1e3*t.start).getFullYear()==parseInt(a))))},[i,l,c,r,a,n,t=>`${t.title} (${q.timestamp(t.start,"DD-MM-YYYY")})`]}export default class extends t{constructor(t){super(),e(this,t,z,H,s,{events:0,tags:1,years:2})}}export{S as load};
